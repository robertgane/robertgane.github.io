<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Queens â€“ 4 in a Row</title>

<style>
  :root {
    --board-size: 360px;
    --light: #f5f6fa;
    --dark: #3d3d3d;
    --accent: #4caf50;
    --gold: #f5c542;
  }

  body {
    margin: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    background: radial-gradient(circle at top, #222, #0b0b0b);
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  h1 {
    margin: 14px 0 4px;
    font-weight: 600;
  }

  #turn {
    opacity: 0.9;
    margin-bottom: 10px;
  }

  #board {
    width: var(--board-size);
    height: var(--board-size);
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    grid-template-rows: repeat(5, 1fr);
    border-radius: 14px;
    overflow: hidden;
    box-shadow: 0 20px 50px rgba(0,0,0,0.6);
    border: 2px solid #555;
  }

  .cell {
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
    transition: background 0.15s ease;
  }

  .light { background: var(--light); }
  .dark { background: #9fa0a5; }

  .cell.highlight {
    background: var(--accent) !important;
  }

  .cell.selected {
    box-shadow: inset 0 0 0 3px var(--gold);
  }

  .queen {
    width: 60%;
    height: 60%;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.4rem;
    font-weight: bold;
    box-shadow: 0 6px 12px rgba(0,0,0,0.4);
  }

  .whiteQ {
    background: linear-gradient(145deg, #ffffff, #dcdcdc);
    color: #111;
  }

  .blackQ {
    background: linear-gradient(145deg, #111, #444);
    color: #fff;
  }

  #message {
    margin-top: 12px;
    font-size: 1.2rem;
  }

  button {
    margin-top: 12px;
    padding: 10px 22px;
    font-size: 1rem;
    border-radius: 20px;
    border: none;
    background: linear-gradient(145deg, #4caf50, #3c8f40);
    color: white;
    cursor: pointer;
    box-shadow: 0 6px 14px rgba(0,0,0,0.4);
  }

  button:active {
    transform: scale(0.96);
  }

  @media (max-width: 420px) {
    :root {
      --board-size: 90vmin;
    }

  .cell.invalid {
  animation: invalidFlash 0.3s;
}

@keyframes invalidFlash {
  0% { background-color: #f44336; } /* red flash */
  50% { background-color: inherit; }
  100% { background-color: inherit; }
}
</style>
</head>

<body>

<h1>ðŸ‘‘ Queens</h1>
<div id="turn">Whiteâ€™s Turn</div>

<div id="board"></div>

<div id="message"></div>
<button id="resetBtn" onclick="resetGame()" style="display:none;">Reset Game</button>

<script>
  const size = 5;
  const board = document.getElementById("board");
  const turnText = document.getElementById("turn");
  const message = document.getElementById("message");
  const resetBtn = document.getElementById("resetBtn");

  let currentPlayer = "W";
  let selected = null;
  let gameOver = false;

  let state;

  function initState() {
    state = Array.from({ length: size }, () => Array(size).fill(null));

    // White
    state[0][0] = "W";
    state[4][1] = "W";
    state[0][2] = "W";
    state[4][3] = "W";
    state[0][4] = "W";

    // Black
    state[4][0] = "B";
    state[0][1] = "B";
    state[4][2] = "B";
    state[0][3] = "B";
    state[4][4] = "B";
  }

  function drawBoard() {
    board.innerHTML = "";
    for (let r = 0; r < size; r++) {
      for (let c = 0; c < size; c++) {
        const cell = document.createElement("div");
        cell.className = "cell " + ((r + c) % 2 ? "dark" : "light");
        cell.dataset.r = r;
        cell.dataset.c = c;

        if (state[r][c]) {
          const q = document.createElement("div");
          q.className = "queen " + (state[r][c] === "W" ? "whiteQ" : "blackQ");
          q.textContent = "Q";
          cell.appendChild(q);
        }

        cell.onclick = () => handleTap(r, c);
        board.appendChild(cell);
      }
    }
  }

  function handleTap(r, c) {
  if (gameOver) return;

  const cellValue = state[r][c];

  if (selected) {
    // Clicked the same piece â†’ deselect
    if (selected.r === r && selected.c === c) {
      selected = null;
    }
    // Clicked a different piece of the same player â†’ switch selection
    else if (cellValue === currentPlayer) {
      selected = { r, c };
    }
    // Clicked a valid empty cell â†’ move
    else if (isValidMove(selected.r, selected.c, r, c)) {
      moveQueen(selected.r, selected.c, r, c);
      selected = null;

      drawBoard();

      setTimeout(() => {
        if (checkWin(currentPlayer)) {
          message.textContent =
            (currentPlayer === "W" ? "White" : "Black") + " wins! ðŸŽ‰";
          gameOver = true;
          resetBtn.style.display = "inline-block";
        } else {
          currentPlayer = currentPlayer === "W" ? "B" : "W";
          turnText.textContent =
            currentPlayer === "W" ? "Whiteâ€™s Turn" : "Blackâ€™s Turn";
        }
      }, 30);

      return; // exit early to avoid re-drawing twice
    }
    // Clicked an invalid cell â†’ deselect and flash red
    else {
      selected = null;

      const cell = document.querySelector(`.cell[data-r="${r}"][data-c="${c}"]`);
      if (cell) {
        cell.classList.add("invalid");
        setTimeout(() => cell.classList.remove("invalid"), 300);
      }
    }
  } 
  // No selection yet â†’ select if itâ€™s the playerâ€™s queen
  else if (cellValue === currentPlayer) {
    selected = { r, c };
  }

  drawBoard();
  if (selected) highlightMoves(selected.r, selected.c);
}

  function highlightMoves(r, c) {
    const dirs = [[1,0],[-1,0],[0,1],[0,-1],[1,1],[1,-1],[-1,1],[-1,-1]];
    dirs.forEach(([dr,dc]) => {
      let nr=r+dr, nc=c+dc;
      while (nr>=0 && nr<size && nc>=0 && nc<size) {
        if (state[nr][nc]) break;
        document.querySelector(`.cell[data-r="${nr}"][data-c="${nc}"]`)
          .classList.add("highlight");
        nr+=dr; nc+=dc;
      }
    });
    document.querySelector(`.cell[data-r="${r}"][data-c="${c}"]`)
      .classList.add("selected");
  }

  function isValidMove(r1,c1,r2,c2) {
    if (state[r2][c2]) return false;
    if (r1!==r2 && c1!==c2 && Math.abs(r2-r1)!==Math.abs(c2-c1)) return false;

    const dr=Math.sign(r2-r1), dc=Math.sign(c2-c1);
    let r=r1+dr, c=c1+dc;
    while (r!==r2 || c!==c2) {
      if (state[r][c]) return false;
      r+=dr; c+=dc;
    }
    return true;
  }

  function moveQueen(r1,c1,r2,c2) {
    state[r2][c2]=state[r1][c1];
    state[r1][c1]=null;
  }

  function checkWin(p) {
    const dirs=[[1,0],[0,1],[1,1],[1,-1]];
    for (let r=0;r<size;r++) for (let c=0;c<size;c++) {
      if (state[r][c]!==p) continue;
      for (const [dr,dc] of dirs) {
        let count=1, nr=r+dr, nc=c+dc;
        while (nr>=0&&nr<size&&nc>=0&&nc<size&&state[nr][nc]===p) {
          if (++count===4) return true;
          nr+=dr; nc+=dc;
        }
      }
    }
    return false;
  }

  function resetGame() {
    gameOver = false;
    currentPlayer = "W";
    selected = null;
    message.textContent = "";
    resetBtn.style.display = "none";
    turnText.textContent = "Whiteâ€™s Turn";
    initState();
    drawBoard();
  }

  initState();
  drawBoard();
</script>

</body>
</html>
