<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Queens â€“ 4 in a Row</title>

<style>
  body {
    margin: 0;
    font-family: system-ui, Arial, sans-serif;
    background: #111;
    color: white;
    text-align: center;
  }

  h1 {
    margin: 10px 0 4px;
  }

  #turn {
    margin-bottom: 6px;
    font-size: 1rem;
  }

  #board {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    width: 90vmin;
    height: 90vmin;
    max-width: 360px;
    max-height: 360px;
    margin: auto;
    border: 3px solid white;
  }

  .cell {
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 7vmin;
    user-select: none;
  }

  .light { background: #eee; color: black; }
  .dark { background: #777; color: black; }

  .highlight {
    background: #4caf50 !important;
  }

  .selected {
    outline: 3px solid gold;
  }

  #message {
    margin-top: 8px;
    font-size: 1.1rem;
  }
</style>
</head>

<body>

<h1>ðŸ‘‘ Queens</h1>
<div id="turn">Whiteâ€™s Turn</div>
<div id="board"></div>
<div id="message"></div>

<script>
  const size = 5;
  const board = document.getElementById("board");
  const turnText = document.getElementById("turn");
  const message = document.getElementById("message");

  let currentPlayer = "W";
  let selected = null;

  let state = Array.from({ length: size }, () => Array(size).fill(null));

  function setupPieces() {
    // Player 1 (White)
    state[0][0] = "W"; // a1
    state[4][1] = "W"; // b5
    state[0][2] = "W"; // c1
    state[4][3] = "W"; // d5
    state[0][4] = "W"; // e1

    // Player 2 (Black)
    state[4][0] = "B"; // a5
    state[0][1] = "B"; // b1
    state[4][2] = "B"; // c5
    state[0][3] = "B"; // d1
    state[4][4] = "B"; // e5
  }

  function drawBoard() {
    board.innerHTML = "";
    for (let r = 0; r < size; r++) {
      for (let c = 0; c < size; c++) {
        const cell = document.createElement("div");
        cell.className = "cell " + ((r + c) % 2 ? "dark" : "light");
        cell.dataset.r = r;
        cell.dataset.c = c;

        if (state[r][c]) {
          cell.textContent = state[r][c] === "W" ? "â™•" : "â™›";
        }

        cell.onclick = () => handleTap(r, c);
        board.appendChild(cell);
      }
    }
  }

  function handleTap(r, c) {
    if (selected) {
      if (isValidMove(selected.r, selected.c, r, c)) {
        moveQueen(selected.r, selected.c, r, c);
        clearSelection();
        if (checkWin(currentPlayer)) {
          message.textContent =
            (currentPlayer === "W" ? "White" : "Black") + " wins! ðŸŽ‰";
          board.style.pointerEvents = "none";
          return;
        }
        currentPlayer = currentPlayer === "W" ? "B" : "W";
        turnText.textContent =
          currentPlayer === "W" ? "Whiteâ€™s Turn" : "Blackâ€™s Turn";
      } else {
        clearSelection();
      }
    } else if (state[r][c] === currentPlayer) {
      selectQueen(r, c);
    }
  }

  function selectQueen(r, c) {
    selected = { r, c };
    drawBoard();
    highlightMoves(r, c);
    getCell(r, c).classList.add("selected");
  }

  function clearSelection() {
    selected = null;
    drawBoard();
  }

  function getCell(r, c) {
    return document.querySelector(
      `.cell[data-r="${r}"][data-c="${c}"]`
    );
  }

  function highlightMoves(r, c) {
    const directions = [
      [1,0], [-1,0], [0,1], [0,-1],
      [1,1], [1,-1], [-1,1], [-1,-1]
    ];

    for (const [dr, dc] of directions) {
      let nr = r + dr;
      let nc = c + dc;
      while (nr >= 0 && nr < size && nc >= 0 && nc < size) {
        if (state[nr][nc]) break;
        getCell(nr, nc).classList.add("highlight");
        nr += dr;
        nc += dc;
      }
    }
  }

  function isValidMove(r1, c1, r2, c2) {
    if (state[r2][c2]) return false;

    if (
      r1 !== r2 &&
      c1 !== c2 &&
      Math.abs(r2 - r1) !== Math.abs(c2 - c1)
    ) return false;

    const dr = Math.sign(r2 - r1);
    const dc = Math.sign(c2 - c1);

    let r = r1 + dr;
    let c = c1 + dc;
    while (r !== r2 || c !== c2) {
      if (state[r][c]) return false;
      r += dr;
      c += dc;
    }
    return true;
  }

  function moveQueen(r1, c1, r2, c2) {
    state[r2][c2] = state[r1][c1];
    state[r1][c1] = null;
    drawBoard();
  }

  function checkWin(player) {
    const directions = [[1,0],[0,1],[1,1],[1,-1]];

    for (let r = 0; r < size; r++) {
      for (let c = 0; c < size; c++) {
        if (state[r][c] !== player) continue;

        for (const [dr, dc] of directions) {
          let count = 1;
          let nr = r + dr;
          let nc = c + dc;

          while (
            nr >= 0 && nr < size &&
            nc >= 0 && nc < size &&
            state[nr][nc] === player
          ) {
            count++;
            if (count === 4) return true;
            nr += dr;
            nc += dc;
          }
        }
      }
    }
    return false;
  }

  setupPieces();
  drawBoard();
</script>

</body>
</html>
